function jsmarty_function_mailto(r,q){if(!r.address){q.trigger_error("mailto: missing 'address' parameter");return "";}var H,D=0,O=[];var C,d,A,S,V;C=d="";A=S=r.address;for(H in r){switch(H){case "cc":case "bcc":case "followupto":O[D++]=H+"="+r[H].replace("%40","@");break;case "subject":case "newsgroups":O[D++]=H+"="+r[H];break;case "extra":C=r[H];break;case "text":A=r[H];break;}}for(H=0;H<D;H++){d+=(0==D)?"?":"&";d+=mail_params[H];}S+=d;V=(r.encode)?r.encode:"none";switch(V){case "hex":var w=[],F=[];for(H=0,f=S.length;H<f;H++){if(S.charAt(H).match(/\w/)){F[H]="%"+S.charCodeAt(H).toString(16);}else{F[H]=S.charAt(H);}}for(H=0,f=A.length;H<f;H++){w[H]="&#"+A.charCodeAt(H)+";";}mailto="&#109;&#97;&#105;&#108;&#116;&#111;&#58;";return "<a href=\""+mailto+F.join("")+"\""+C+">"+w.join("")+"</a>";case "none":return "<a href=\"mailto:"+S+"\" "+C+">"+A+"</a>";case "javascript":var j=[],s="document.write('<a href=\"mailto:"+S+"\" "+C+">"+A+"</a>');";for(H=0,f=s.length;H<f;H++){j[H]="%"+s.charCodeAt(H).toString(16);}return "<script type=\"text/javascript\">eval(unescape('"+j.join("")+"'))</"+"script>";case "javascript_charcode":var I=[],s="<a href=\"mailto:"+S+"\" "+C+">"+A+"</a>";for(H=0,f=s.length;H<f;H++){I[H]=s.charCodeAt(H);}s=["<script type=\"text/javascript\" language=\"JavaScript\">","document.write(String.fromCharCode("+I.join()+"))","</"+"script>"];return s.join("\n");default:q.trigger_error("mailto: 'encode' parameter must be none, javascript or hex");return "";}}